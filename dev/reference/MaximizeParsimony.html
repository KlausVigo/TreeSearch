<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Find most parsimonious trees — MaximizeParsimony • TreeSearch</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>


<!-- docsearch -->
<script src="../docsearch.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous" />
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>



<meta property="og:title" content="Find most parsimonious trees — MaximizeParsimony" />
<meta property="og:description" content="Search for most parsimonious trees using the parsimony ratchet and
TBR rearrangements, treating inapplicable data as such using the
algorithm of Brazeau, Guillerme &amp;amp; Smith (2019).
Tree search will be conducted from a specified or automatically-generated
starting tree in order to find a tree with an optimal parsimony score,
under implied or equal weights, treating inapplicable characters as such
in order to avoid the artefacts of the standard Fitch algorithm
(see Maddison 1993; Brazeau et al. 2019).
The tree scoring implementation uses the MorphyLib C library (Brazeau 2017)." />


<meta name="robots" content="noindex">

<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-156666971-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-156666971-5');
</script>


  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">TreeSearch</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">0.4.3.9007</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/custom.html">Tree Search with Custom Optimality Criteria</a>
    </li>
    <li>
      <a href="../articles/getting-started.html">Getting started: Installing R and TreeSearch</a>
    </li>
    <li>
      <a href="../articles/inapplicable.html">Tree search with inapplicable data</a>
    </li>
    <li>
      <a href="../articles/profile-scores.html">Calculating concavity profiles for profile parsimony</a>
    </li>
    <li>
      <a href="../articles/profile.html">Tree Search with Profile Parsimony</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/ms609/TreeSearch/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
      <form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
        </div>
      </form>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Find most parsimonious trees</h1>
    <small class="dont-index">Source: <a href='https://github.com/ms609/TreeSearch/blob/master/R/MaximizeParsimony.R'><code>R/MaximizeParsimony.R</code></a></small>
    <div class="hidden name"><code>MaximizeParsimony.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Search for most parsimonious trees using the parsimony ratchet and
<acronym>TBR</acronym> rearrangements, treating inapplicable data as such using the
algorithm of Brazeau, Guillerme &amp; Smith (2019).</p>
<p>Tree search will be conducted from a specified or automatically-generated
starting tree in order to find a tree with an optimal parsimony score,
under implied or equal weights, treating inapplicable characters as such
in order to avoid the artefacts of the standard Fitch algorithm
(see Maddison 1993; Brazeau et al. 2019).
The tree scoring implementation uses the MorphyLib C library (Brazeau 2017).</p>
    </div>

    <pre class="usage"><span class='fu'>MaximizeParsimony</span><span class='op'>(</span>
  <span class='va'>dataset</span>,
  tree <span class='op'>=</span> <span class='fu'><a href='https://ms609.github.io/TreeTools/reference/NJTree.html'>NJTree</a></span><span class='op'>(</span><span class='va'>dataset</span><span class='op'>)</span>,
  ratchIter <span class='op'>=</span> <span class='fl'>12L</span>,
  tbrIter <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>ceiling</a></span><span class='op'>(</span><span class='fu'><a href='https://ms609.github.io/TreeTools/reference/NTip.html'>NTip</a></span><span class='op'>(</span><span class='va'>dataset</span><span class='op'>)</span><span class='op'>/</span><span class='fl'>3</span><span class='op'>)</span>,
  startIter <span class='op'>=</span> <span class='fl'>3L</span>,
  finalIter <span class='op'>=</span> <span class='fl'>1L</span>,
  maxHits <span class='op'>=</span> <span class='fu'><a href='https://ms609.github.io/TreeTools/reference/NTip.html'>NTip</a></span><span class='op'>(</span><span class='va'>dataset</span><span class='op'>)</span> <span class='op'>*</span> <span class='fl'>4L</span>,
  quickHits <span class='op'>=</span> <span class='fl'>1</span><span class='op'>/</span><span class='fl'>3</span>,
  concavity <span class='op'>=</span> <span class='cn'>Inf</span>,
  tolerance <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span><span class='va'>.Machine</span><span class='op'>$</span><span class='va'>double.eps</span><span class='op'>)</span>,
  constraint <span class='op'>=</span> <span class='cn'>NULL</span>,
  verbosity <span class='op'>=</span> <span class='fl'>2L</span>,
  session <span class='op'>=</span> <span class='cn'>NULL</span>
<span class='op'>)</span>

<span class='fu'>Resample</span><span class='op'>(</span>
  <span class='va'>dataset</span>,
  tree <span class='op'>=</span> <span class='fu'><a href='https://ms609.github.io/TreeTools/reference/NJTree.html'>NJTree</a></span><span class='op'>(</span><span class='va'>dataset</span><span class='op'>)</span>,
  method <span class='op'>=</span> <span class='st'>"jack"</span>,
  proportion <span class='op'>=</span> <span class='fl'>2</span><span class='op'>/</span><span class='fl'>3</span>,
  ratchIter <span class='op'>=</span> <span class='fl'>1L</span>,
  tbrIter <span class='op'>=</span> <span class='fl'>8L</span>,
  finalIter <span class='op'>=</span> <span class='fl'>3L</span>,
  maxHits <span class='op'>=</span> <span class='fl'>12L</span>,
  concavity <span class='op'>=</span> <span class='cn'>Inf</span>,
  tolerance <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span><span class='va'>.Machine</span><span class='op'>$</span><span class='va'>double.eps</span><span class='op'>)</span>,
  constraint <span class='op'>=</span> <span class='cn'>NULL</span>,
  verbosity <span class='op'>=</span> <span class='fl'>2L</span>,
  session <span class='op'>=</span> <span class='cn'>NULL</span>
<span class='op'>)</span>

<span class='fu'>EasyTrees</span><span class='op'>(</span><span class='op'>)</span>

<span class='fu'>EasyTreesy</span><span class='op'>(</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>dataset</th>
      <td><p>A phylogenetic data matrix of class <code><a href='https://rdrr.io/pkg/phangorn/man/phyDat.html'>phyDat</a></code>,
whose names correspond to the labels of any accompanying tree.</p></td>
    </tr>
    <tr>
      <th>tree</th>
      <td><p>(optional) A bifurcating tree of class <code>phylo</code>,
containing only the tips listed in <code>dataset</code>, from which the search
should begin.
If unspecified, a neighbour-joining tree will be generated from <code>dataset</code>.
Edge lengths are not supported and will be deleted.</p></td>
    </tr>
    <tr>
      <th>ratchIter</th>
      <td><p>Numeric specifying number of iterations of the
parsimony ratchet (Nixon 1999) to conduct.</p></td>
    </tr>
    <tr>
      <th>tbrIter</th>
      <td><p>Numeric specifying the maximum number of <acronym>TBR</acronym>
break points to evaluate before concluding each search.
The counter is reset to zero each time tree score improves.
One 'iteration' comprises breaking a single branch and evaluating all
possible reconnections.</p></td>
    </tr>
    <tr>
      <th>startIter</th>
      <td><p>Numeric: an initial round of tree search with
<code>startIter</code> &amp;teims; <code>tbrIter</code> <acronym>TBR</acronym> break points is conducted in
order to locate a local optimum before beginning ratchet searches.</p></td>
    </tr>
    <tr>
      <th>finalIter</th>
      <td><p>Numeric: a final round of tree search will evaluate
<code>finalIter</code> × <code>tbrIter</code> <acronym>TBR</acronym> break points, in order to
sample the final optimal neighbourhood more intensely.</p></td>
    </tr>
    <tr>
      <th>maxHits</th>
      <td><p>Numeric specifying the maximum times that an optimal
parsimony score may be hit before concluding a ratchet iteration or final
search concluded.</p></td>
    </tr>
    <tr>
      <th>quickHits</th>
      <td><p>Numeric: iterations on subsampled datasets
will retain <code>quickHits</code> × <code>maxHits</code> trees with the best score.</p></td>
    </tr>
    <tr>
      <th>concavity</th>
      <td><p>Numeric specifying concavity constant for implied step
weighting; set as <code>Inf</code> for equal step weights (which is a bad idea; see
Smith 2019).</p></td>
    </tr>
    <tr>
      <th>tolerance</th>
      <td><p>Numeric specifying degree of suboptimality to tolerate
before rejecting a tree.  The default, <code><a href='https://rdrr.io/r/base/MathFun.html'>sqrt(.Machine$double.eps)</a></code>, retains
trees that may be equally parsimonious but for rounding errors.
Setting to larger values will include trees suboptimal by up to <code>tolerance</code>
in search results, which may improve the accuracy of the consensus tree
(at the expense of resolution) (Smith 2019).</p></td>
    </tr>
    <tr>
      <th>constraint</th>
      <td><p>Either <code>NULL</code> or an object of class <code>phyDat</code>. Trees that
are not perfectly compatible with each character in <code>constraint</code> will not
be considered during search.
See <a href='https://ms609.github.io/TreeSearch/articles/inapplicable.html'>vignette</a>
for further examples.</p></td>
    </tr>
    <tr>
      <th>verbosity</th>
      <td><p>Integer specifying level of messaging; higher values give
more detailed commentary on search progress. Set to <code>0</code> to run silently.</p></td>
    </tr>
    <tr>
      <th>session</th>
      <td><p>'shiny' session identifier to allow <code>setProgress()</code> calls
to be sent when <code>MaximizeParsimony()</code> is called from within a shiny app..</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>Unambiguous abbreviation of <code>jackknife</code> or <code>bootstrap</code>
specifying how to resample characters.  Note that jackknife is considered
to give more meaningful results.</p></td>
    </tr>
    <tr>
      <th>proportion</th>
      <td><p>Numeric between 0 and 1 specifying what proportion of
characters to retain under jackknife resampling.</p>
<p>Note that bootstrap support is a measure of the amount of data supporting
a split, rather than the amount of confidence that should be afforded the
grouping.
"Bootstrap support of 100% is not enough, the tree must also be correct"
(Phillips et al. 2004).
See discussion in Egan 2006; Wägele <em>et al</em>. (2009), Kumar <em>et al.</em> 2011.</p>
<p>For a discussion of suitable search parameters in resampling estimates, see
Müller (2005).  The user should decide whether to start each resampling
from the optimal tree (which may be quicker, but result in overestimated
support values as searches get stuck in local optima close to the
optimal tree) or a random tree (which may take longer as more rearrangements
are necessary to find an optimal tree on each iteration).</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>MaximizeParsimony()</code> returns a list of trees with class
<code>multiPhylo</code>. This lists all trees found during each search step that
are within <code>tolerance</code> of the optimal score; it may contain more than
<code>maxHits</code> elements.
Note that the default search parameters may need to be increased in order for
these trees to be the globally optimal trees; examine the messages printed
duriung tree search to evaluate whether the optimal score has stabilized.</p>
<p><code>Resample()</code> returns a <code>multiPhylo</code> object containing a list of
trees obtained by tree search using a resampled version of <code>dataset</code>.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Tree search commences with <code>ratchIter</code> iterations of the parsimony ratchet
(Nixon 1999), which bootstraps the input dataset in order to escape local
optima.  A final round of tree bisection and reconnection (<acronym>TBR</acronym>)
is conducted to broaden the sampling of trees.</p>
<p>This function can be called using the R command line / terminal, or through
the 'shiny' graphical user interface app (type <code>EasyTrees()</code> to launch).</p>
<p>For detailed documentation of the 'TreeSearch' package, including full
instructions for loading phylogenetic data into R and initiating and
configuring tree search, see the
<a href='https://ms609.github.io/TreeSearch'>package documentation</a>.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Brazeau MD, Smith MR, Guillerme T (2017).
&#8220;MorphyLib: a library for phylogenetic analysis of categorical trait data with inapplicability.&#8221;
doi: <a href='https://doi.org/10.5281/zenodo.815372'>10.5281/zenodo.815372</a>
, <a href='https://doi.org/10.5281/zenodo.815372'>https://doi.org/10.5281/zenodo.815372</a>.</p>
<p>Brazeau MD, Guillerme T, Smith MR (2019).
&#8220;An algorithm for morphological phylogenetic analysis with inapplicable data.&#8221;
<em>Systematic Biology</em>, <b>68</b>(4), 619--631.
doi: <a href='https://doi.org/10.1093/sysbio/syy083'>10.1093/sysbio/syy083</a>
, <a href='https://doi.org/10.1093/sysbio/syy083'>https://doi.org/10.1093/sysbio/syy083</a>.</p>
<p>Maddison WP (1993).
&#8220;Missing data versus missing characters in phylogenetic analysis.&#8221;
<em>Systematic Biology</em>, <b>42</b>(4), 576--581.
doi: <a href='https://doi.org/10.1093/sysbio/42.4.576'>10.1093/sysbio/42.4.576</a>
, <a href='https://doi.org/10.1093/sysbio/42.4.576'>https://doi.org/10.1093/sysbio/42.4.576</a>.</p>
<p>Nixon KC (1999).
&#8220;The Parsimony Ratchet, a new method for rapid parsimony analysis.&#8221;
<em>Cladistics</em>, <b>15</b>(4), 407--414.
ISSN 0748-3007, doi: <a href='https://doi.org/10.1111/j.1096-0031.1999.tb00277.x'>10.1111/j.1096-0031.1999.tb00277.x</a>
, <a href='https://doi.org/10.1111/j.1096-0031.1999.tb00277.x'>https://doi.org/10.1111/j.1096-0031.1999.tb00277.x</a>.</p>
<p>Smith MR (2019).
&#8220;Bayesian and parsimony approaches reconstruct informative trees from simulated morphological datasets.&#8221;
<em>Biology Letters</em>, <b>15</b>(2), 20180632.
doi: <a href='https://doi.org/10.1098/rsbl.2018.0632'>10.1098/rsbl.2018.0632</a>
, <a href='https://doi.org/10.1098/rsbl.2018.0632'>https://doi.org/10.1098/rsbl.2018.0632</a>.</p>
<p>Egan MG (2006).
&#8220;Support versus corroboration.&#8221;
<em>Journal of Biomedical Informatics</em>, <b>39</b>(1), 72--85.
doi: <a href='https://doi.org/10.1016/j.jbi.2005.11.007'>10.1016/j.jbi.2005.11.007</a>
, <a href='https://doi.org/10.1016/j.jbi.2005.11.007'>https://doi.org/10.1016/j.jbi.2005.11.007</a>.</p>
<p>Kumar S, Filipski AJ, Battistuzzi FU, Kosakovsky Pond SL, Tamura K (2012).
&#8220;Statistics and truth in phylogenomics.&#8221;
<em>Molecular Biology and Evolution</em>, <b>29</b>(2), 457--472.
doi: <a href='https://doi.org/10.1093/molbev/msr202'>10.1093/molbev/msr202</a>
, <a href='https://doi.org/10.1093/molbev/msr202'>https://doi.org/10.1093/molbev/msr202</a>.</p>
<p>Müller KF (2005).
&#8220;The efficiency of different search strategies in estimating parsimony jackknife, bootstrap, and Bremer support.&#8221;
<em>BMC Evolutionary Biology</em>, <b>5</b>(1), 58.
doi: <a href='https://doi.org/10.1186/1471-2148-5-58'>10.1186/1471-2148-5-58</a>
, <a href='https://doi.org/10.1186/1471-2148-5-58'>https://doi.org/10.1186/1471-2148-5-58</a>.</p>
<p>Phillips MJ, Delsuc F, Penny D (2004).
&#8220;Genome-scale phylogeny and the detection of systematic biases.&#8221;
<em>Molecular biology and evolution</em>, <b>21</b>(7), 1455--8.
doi: <a href='https://doi.org/10.1093/molbev/msh137'>10.1093/molbev/msh137</a>
, <a href='https://doi.org/10.1093/molbev/msh137'>https://doi.org/10.1093/molbev/msh137</a>.</p>
<p>Simmons MP, Freudenstein JV (2011).
&#8220;Spurious 99\% bootstrap and jackknife support for unsupported clades.&#8221;
<em>Molecular Phylogenetics and Evolution</em>, <b>61</b>(1), 177--191.
doi: <a href='https://doi.org/10.1016/j.ympev.2011.06.003'>10.1016/j.ympev.2011.06.003</a>
, <a href='https://doi.org/10.1016/j.ympev.2011.06.003'>https://doi.org/10.1016/j.ympev.2011.06.003</a>.</p>
<p>Wägele JW, Letsch H, Klussmann-Kolb A, Mayer C, Misof B, Wägele H (2009).
&#8220;Phylogenetic support values are not necessarily informative: the case of the Serialia hypothesis (a mollusk phylogeny).&#8221;
<em>Frontiers in Zoology</em>, <b>6</b>(1), 12--29.
doi: <a href='https://doi.org/10.1186/1742-9994-6-12'>10.1186/1742-9994-6-12</a>
, <a href='https://doi.org/10.1186/1742-9994-6-12'>https://doi.org/10.1186/1742-9994-6-12</a>.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Other split support functions: 
<code><a href='JackLabels.html'>JackLabels</a>()</code>,
<code><a href='Jackknife.html'>Jackknife</a>()</code>,
<code><a href='SiteConcordance.html'>SiteConcordance</a></code></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p><a href='https://smithlabdurham.github.io/'>Martin R. Smith</a>
(<a href='mailto:martin.smith@durham.ac.uk'>martin.smith@durham.ac.uk</a>)</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span>  <span class='co'># launch 'shiny' point-and-click interface</span>
  <span class='co'># Here too, use the "continue search" function to ensure that tree score</span>
  <span class='co'># has stabilized and a global optimum has been found</span>
  <span class='fu'>EasyTrees</span><span class='op'>(</span><span class='op'>)</span>



<span class='co'># Load data for analysis in R</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='st'><a href='https://ms609.github.io/TreeTools/'>'TreeTools'</a></span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='st'>'congreveLamsdellMatrices'</span>, package <span class='op'>=</span> <span class='st'>'TreeSearch'</span><span class='op'>)</span>
<span class='va'>dataset</span> <span class='op'>&lt;-</span> <span class='va'>congreveLamsdellMatrices</span><span class='op'>[[</span><span class='fl'>42</span><span class='op'>]</span><span class='op'>]</span>

<span class='co'># A very quick run for demonstration purposes</span>
<span class='va'>trees</span> <span class='op'>&lt;-</span> <span class='fu'>MaximizeParsimony</span><span class='op'>(</span><span class='va'>dataset</span>, ratchIter <span class='op'>=</span> <span class='fl'>0</span>, tbrIter <span class='op'>=</span> <span class='fl'>1</span>, 
                          concavity <span class='op'>=</span> <span class='fl'>10</span>, maxHits <span class='op'>=</span> <span class='fl'>3</span>, verbosity <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>- Find local optimum: TBR depth 3; keeping 3 trees; k = 10.</span>
#&gt; <span class='message'>  2021-05-13 13:29:11</span>
#&gt; <span class='message'>  Initial score: 12.506</span></div><div class='output co'>#&gt; <span class='message'>   - New TBR iteration (depth 1, score 12.506)</span></div><div class='output co'>#&gt; <span class='message'>   - New TBR iteration (depth 1, score 11.97)</span></div><div class='output co'>#&gt; <span class='message'>   - New TBR iteration (depth 2, score 11.97)</span></div><div class='output co'>#&gt; <span class='message'>   - New TBR iteration (depth 3, score 11.97)</span></div><div class='output co'>#&gt; <span class='message'>  - 4 TBR rearrangements found score 11.9697 1 times.</span></div><div class='output co'>#&gt; <span class='message'>- Sample local optimum: TBR depth 1; keeping 3 trees; k = 10.</span>
#&gt; <span class='message'>  2021-05-13 13:29:12</span>
#&gt; <span class='message'>  Initial score: 11.97</span></div><div class='output co'>#&gt; <span class='message'>   - New TBR iteration (depth 1, score 11.97)</span></div><div class='output co'>#&gt; <span class='message'>  - 2 TBR rearrangements found score 11.9697 1 times.</span></div><div class='output co'>#&gt; <span class='message'>- 2021-05-13 13:29:12: Final score: 11.9697067638244</span>
#&gt; <span class='message'></span></div><div class='input'>                  
<span class='co'># In actual use, be sure to check that the score has converged on a global</span>
<span class='co'># optimum, conducting additional iterations and runs as necessary.</span>
                  
<span class='co'># Jackknife resampling</span>
<span class='va'>nReplicates</span> <span class='op'>&lt;-</span> <span class='fl'>5</span>
<span class='va'>jackTrees</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>replicate</a></span><span class='op'>(</span><span class='va'>nReplicates</span>,
  <span class='fu'>Resample</span><span class='op'>(</span><span class='va'>dataset</span>, <span class='va'>trees</span>, ratchIter <span class='op'>=</span> <span class='fl'>0</span>, tbrIter <span class='op'>=</span> <span class='fl'>1</span>, maxHits <span class='op'>=</span> <span class='fl'>4</span>,
           concavity <span class='op'>=</span> <span class='fl'>10</span>, verbosity <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span>
 <span class='op'>)</span>

<span class='co'># In a serious analysis, more replicates would be conducted, and each</span>
<span class='co'># search would undergo more iterations.</span>

<span class='co'># Now we must decide what to do with the multiple optimal trees from</span>
<span class='co'># each replicate.</span>

<span class='co'># Treat each tree equally</span>
<span class='fu'><a href='JackLabels.html'>JackLabels</a></span><span class='op'>(</span><span class='fu'>ape</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/ape/man/consensus.html'>consensus</a></span><span class='op'>(</span><span class='va'>trees</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/unlist.html'>unlist</a></span><span class='op'>(</span><span class='va'>jackTrees</span>, recursive <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='img'><img src='MaximizeParsimony-1.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt;         25         26         27         28         29         30         31 
#&gt; 0.53571429 0.53571429 0.25000000 0.25000000 0.03571429 0.64285714 0.89285714 
#&gt;         32         33         34         35         36         37         38 
#&gt; 0.50000000 0.85714286 0.60714286 0.71428571 0.78571429 0.17857143 0.53571429 
#&gt;         39         40         41         42         43 
#&gt; 0.82142857 0.46428571 1.00000000 1.00000000 1.00000000 </div><div class='input'>
<span class='co'># Take the strict consensus of all trees for each replicate</span>
<span class='fu'><a href='JackLabels.html'>JackLabels</a></span><span class='op'>(</span><span class='fu'>ape</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/ape/man/consensus.html'>consensus</a></span><span class='op'>(</span><span class='va'>trees</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='va'>jackTrees</span>, <span class='fu'>ape</span><span class='fu'>::</span><span class='va'><a href='https://rdrr.io/pkg/ape/man/consensus.html'>consensus</a></span><span class='op'>)</span><span class='op'>)</span>
</div><div class='img'><img src='MaximizeParsimony-2.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt;  25  26  27  28  29  30  31  32  33  34  35  36  37  38  39  40  41  42  43 
#&gt; 0.4 0.4 0.2 0.2 0.0 0.4 0.8 0.6 0.8 0.6 0.8 0.6 0.0 0.4 0.6 0.2 1.0 1.0 1.0 </div><div class='input'>
<span class='co'># Take a single tree from each replicate (the first; order's irrelevant)</span>
<span class='fu'><a href='JackLabels.html'>JackLabels</a></span><span class='op'>(</span><span class='fu'>ape</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/ape/man/consensus.html'>consensus</a></span><span class='op'>(</span><span class='va'>trees</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='va'>jackTrees</span>, <span class='va'>`[[`</span>, <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='img'><img src='MaximizeParsimony-3.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt;  25  26  27  28  29  30  31  32  33  34  35  36  37  38  39  40  41  42  43 
#&gt; 0.8 0.8 0.4 0.4 0.0 0.6 0.8 0.6 1.0 0.6 0.8 1.0 0.4 0.6 0.8 0.6 1.0 1.0 1.0 </div><div class='input'>

<span class='co'># Tree search with a constraint</span>
<span class='va'>constraint</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ms609.github.io/TreeTools/reference/MatrixToPhyDat.html'>MatrixToPhyDat</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>a <span class='op'>=</span> <span class='fl'>1</span>, b <span class='op'>=</span> <span class='fl'>1</span>, c <span class='op'>=</span> <span class='fl'>0</span>, d <span class='op'>=</span> <span class='fl'>0</span>, e <span class='op'>=</span> <span class='fl'>0</span>, f <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>characters</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ms609.github.io/TreeTools/reference/MatrixToPhyDat.html'>MatrixToPhyDat</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>1</span>, <span class='fl'>1</span>, <span class='fl'>0</span>, <span class='fl'>0</span>,
    <span class='fl'>1</span>, <span class='fl'>1</span>, <span class='fl'>1</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span><span class='op'>)</span>, ncol <span class='op'>=</span> <span class='fl'>2</span>,
  dimnames <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>letters</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>6</span><span class='op'>]</span>, <span class='cn'>NULL</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'>MaximizeParsimony</span><span class='op'>(</span><span class='va'>characters</span>, constraint <span class='op'>=</span> <span class='va'>constraint</span>, verbosity <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 1 phylogenetic tree</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://smithlabdurham.github.io/'>Martin R. Smith</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script>
<script>
  docsearch({
    
    
    apiKey: '8422cbc6478f9d3278ad355b48435342',
    indexName: 'treesearch',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>



  </body>
</html>


