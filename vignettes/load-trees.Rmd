---
title: "Loading phylogenetic trees into R"
author: "Martin R. Smith"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
bibliography: ../inst/REFERENCES.bib
csl: ../inst/apa-old-doi-prefix.csl
vignette: >
  %\VignetteIndexEntry{Load phylogenetic trees}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

# Loading phylogenetic trees into R

If a tree is available in a text-based format, it should not be too difficult to
load into R.

## Manual entry

An obvious, if cumbersome, way to enter trees into R is by manual text entry:

```{r text-entry, fig.align='center'}
myTree <- ape::read.tree(text='((A, B), ((C, D), (E, F)));')
plot(myTree)
```

Some gotchas: 

- Ensure that the tree string ends in a semi-colon.

- Make sure that brackets are matched.  Some text editors, such as 
  RStudio or Notepad++, contain built-in syntax highlighting that will highlight 
  the counterpart to each parenthesis as you type.
  
- Look out for ((double brackets)) or brackets enclosing a single node:
  the resultant 'invisible nodes' can cause R to crash.
  
```{r double-bracket, fig.align='center'}
badTree <- ape::read.tree(text='((A, B), (((C, D), ((E), F))));')
plot(badTree)
ape::nodelabels()
```

The text is expected in Newick format, so can contain edge lengths - but edge
lengths must be included for every edge of the tree, or they will be ignored.

```{r branch-lengths, fig.align='center'}
myTree <- ape::read.tree(text='((A:1, B:1):2, ((C:1, D:1):2, (E:1, F:1):2):4);')
plot(myTree)
```

## From a file

First off, make sure that you are comfortable 
[telling R where to find a file](filesystem-navigation.html).

You can load trees from a nexus file using:
```r
filename <- "my_file_name.nex"
ape::read.nexus(filename)
```

If the file contains multiple trees, this will return a list of all trees in
the file, with the class `multiPhylo`.
If there is a single tree, then this will be returned as a tree of class
`phylo` unless the option `force.multiPhylo = TRUE`.  This can be useful when
an unknown number of trees are to be processesed in bulk, for example by

```r
lapply(ape::read.nexus(filename, force.multiPhylo = TRUE), ape::consensus)
```


# What next?

You might want to:

- [Load phylogenetic data](load-data.html) into R.

- Conduct parsimony search using Brazeau, Guillerme & Smith's [approach to inapplicable data](inapplicable.html), or using [Profile parsimony](profile.html).

- [Calculate distances](https://ms609.github.io/TreeDist/Using-TreeDist.html)
  between pairs of trees.

# References